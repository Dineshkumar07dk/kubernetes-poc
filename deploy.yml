---
- name: Run Kubernetes Manifest
  hosts: kubernetes-master
  become: true
  tasks:
    - name: Clone Git Repository
      git:
        repo: https://github.com/Dineshkumar07dk/kubernetes-poc.git
        dest: /home/ubuntu/kubernetes
        force: yes
        
    - name: Apply Pod Manifest
      shell: kubectl apply -f /home/ubuntu/kubernetes/pod.yml
      args:  
        chdir: /home/ubuntu/kubernetes

    - name: Apply Deployment Manifest
      shell: kubectl apply -f /home/ubuntu/kubernetes/Deployment.yml
      args:
        chdir: /home/ubuntu/kubernetes

    - name: Apply NodePort Service Manifest
      shell: kubectl apply -f /home/ubuntu/kubernetes/nodeport.yml
      args:
        chdir: /home/ubuntu/kubernetes
